parameters:
  git_dir: .
  bin_dir: vendor/bin
  ascii:
    failed: ~
    succeeded: ~
  tasks:
    composer:
      strict: true
      metadata:
        priority: 1000
    phpcs:
      standard: ./phpcs.xml
      triggered_by: [php]
      metadata:
        priority: 800
    phpmd:
      exclude: []
      ruleset:
        - ./phpmd.xml
      triggered_by: [php]
      metadata:
        priority: 600
    phpstan:
      autoload_file: ~
      configuration: ./phpstan.neon
      level: 4
      triggered_by: [php]
      metadata:
        priority: 400
    phpunit:
      config_file: ./phpunit.xml
      metadata:
        priority: 200
    dependency-guard:
      metadata:
        priority: 100

services:
  mediact.testing_suite.grumphp.dependency_guard.task:
    class: Mediact\TestingSuite\Composer\GrumPhp\DependencyGuard
    arguments:
      - '@mediact.testing_suite.dependency_guard.composer'
      - '@console.input'
      - '@console.output'
    tags:
      - name: grumphp.task
        config: dependency-guard

  mediact.testing_suite.dependency_guard.composer.io:
    class: Composer\IO\BufferIO

  mediact.testing_suite.dependency_guard.composer.factory:
    class: Composer\Factory

  mediact.testing_suite.dependency_guard.composer:
    class: Composer\Composer
    factory: mediact.testing_suite.dependency_guard.composer.factory:createComposer
    arguments:
      - '@mediact.testing_suite.dependency_guard.composer.io'
